メモ

私は、Excelで学習時間を記録・集計・可視化するためのマクロ付きブックを作成したいです。  
以下の要件を満たすVBAコードを、UserFormおよび標準モジュールに分けて生成してください。  
VBAエディタに貼り付けてすぐに動作するようにしてください。

【目的】
・UserFormを用いて、ユーザーが学習セッションの開始・終了時間をボタンで記録し、内容を入力して記録ボタンで保存できるようにする  
・保存した学習記録を元に、別シートで週別・月別の集計やグラフを表示できるようにする

【UserForm仕様】  
フォーム名：frmStudyLog

### 入力フィールド（表示順）：
1. ラベル：日付 → Submit時にTodayの日付を自動記録  
2. テキストボックス：txtStartTime（開始時間） → ReadOnly = True。  
   「開始時間を記録」ボタン（btnSetStart）を押すと現在時刻が入るだけ  
3. テキストボックス：txtEndTime（終了時間） → ReadOnly = True。  
   「終了時間を記録」ボタン（btnSetEnd）を押すと現在時刻が入る  
4. コンボボックス：cmbSubject（科目） → 以下のリストを設定: 国語、数学、英語、理科、社会  
5. コンボボックス：cmbEvaluation（自己評価） → 以下のリストを設定: 良い、普通、悪い  
6. テキストボックス：txtContent（学習内容） → 任意入力、空欄可  
7. ラベル：学習時間 → Submit時に計算（終了時間 - 開始時間）

### ボタン構成：
- btnSetStart（開始時間を記録）  
- btnSetEnd（終了時間を記録）  
- btnSubmit（記録する）

【保存先】  
「記録」シートに以下の形式で1行追加で追記:  
A列：日付  
B列：開始時間  
C列：終了時間  
D列：学習時間  
E列：科目  
F列：自己評価  
G列：学習内容

【バリデーション・例外処理】  
- 開始時間が未記録のまま終了時間を記録しようとした場合、MsgBoxで警告し処理を止める  
- 終了時間が開始時間より前の場合、MsgBoxでエラー表示し処理中止  
- Submit時に、開始時間・終了時間・科目・自己評価が未入力の場合、MsgBoxで警告し記録を中止する

【集計要件】  
別シート「集計」にて以下を対応（数式やVBAどちらでも可）:  
- 科目別の週別・月別学習時間合計  
- 自己評価別の平均学習時間  
- 学習時間の週別推移（折れ線グラフ）  
- 科目別学習時間割合（円グラフ）

【ユーザーの操作順序】  
1. ユーザーがフォームを開く  
2. 「開始時間を記録」ボタンを押して開始時刻を記録  
3. 学習後、「終了時間を記録」ボタンを押して終了時刻を記録  
4. 記録時に科目、自己評価を選択、学習内容は任意入力  
5. 「記録する」ボタンを押すとデータが「記録」シートに追記される
6.記録されたデータはデーターベースフォームに文字で記録され、それを元にグラフなどの作成をする

【その他】  
- VBAコードはコメント付きで分かりやすく記述  
- UserForm用コードと標準モジュールは分けて記述  
- 記録は追記モード（既存データは残す）  
- 標準モジュールにフォームを起動するShowStudyLogFormサブルーチンを作成  
- UIは分かりやすく、みやすいものであること

以上の仕様を満たすコードを、VBAエディタに直接貼って動作確認できる形で1回の出力でお願いします。